<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Event Details | Eventify</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-pink-100 via-sky-100 to-violet-100 text-gray-800 min-h-screen flex flex-col">


  <nav class="fixed top-0 w-full z-50 glass-effect border-b border-white/20 backdrop-blur-lg">
    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
      <a href="index.html" class="text-3xl font-bold bg-gradient-to-r from-sky-500 to-blue-600 bg-clip-text text-transparent hover:scale-105 transition-transform duration-300">
        Eventify
      </a>
      <ul class="flex space-x-8">
        <li><a href="index.html" class="text-gray-700 hover:text-sky-600 font-medium transition-all duration-300 relative group">
          Home
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-sky-600 transition-all duration-300 group-hover:w-full"></span>
        </a></li>
        <li><a href="about.html" class="text-gray-700 hover:text-sky-600 font-medium transition-all duration-300 relative group">
          About
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-sky-600 transition-all duration-300 group-hover:w-full"></span>
        </a></li>
        <li><a href="events.html" class="text-gray-700 hover:text-sky-600 font-medium transition-all duration-300 relative group">
          Events
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-sky-600 transition-all duration-300 group-hover:w-full"></span>
        </a></li>
        <li><a href="contact.html" class="text-gray-700 hover:text-sky-600 font-medium transition-all duration-300 relative group">
          Contact
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-sky-600 transition-all duration-300 group-hover:w-full"></span>
        </a></li>
        <li><a href="create-event.html" class="bg-gradient-to-r from-sky-500 to-blue-600 text-white px-4 py-2 rounded-full hover:shadow-lg transition-all duration-300 hover:scale-105">Create Event</a></li>
        <li id="userDisplay" class="text-sm text-gray-500"></li>
        <li><a href="login.html" id="loginLink" class="text-gray-700 hover:text-sky-600 font-medium transition-all duration-300">Login</a></li>
        <li><a href="register.html" id="registerLink" class="text-gray-700 hover:text-sky-600 font-medium transition-all duration-300">Register</a></li>
        <li><button id="logoutBtn" class="hidden text-red-500 hover:underline">Logout</button></li>
      </ul>
    </div>
  </nav>


  <main class="flex-grow container mx-auto p-6 max-w-4xl pt-32">
    <div id="eventDetails" class="bg-white/70 backdrop-blur-xl rounded-xl p-8 shadow-xl border border-white/30 text-gray-800">
      <p class="text-center text-gray-500">Loading event details...</p>
    </div>
  </main>


  <footer class="bg-white/50 backdrop-blur-md border-t border-white/30 text-center py-4 text-gray-600">
    <div class="container mx-auto px-6">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="text-xl font-bold text-gray-800 mb-4 md:mb-0">Eventify</div>
        <div class="flex space-x-6 mb-4 md:mb-0">
          <a href="#" class="hover:text-sky-600 transition-colors">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/>
            </svg>
          </a>
          <a href="#" class="hover:text-sky-600 transition-colors">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
            </svg>
          </a>
          <a href="#" class="hover:text-sky-600 transition-colors">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06-4.123 0-.427-.013-.903-.06-1.38-.065-.578-.238-1.155-.534-1.682-.296-.527-.719-.973-1.242-1.312-.527-.334-1.086-.494-1.681-.525-.43-.03-.913-.044-1.38-.044h-.08c-2.643 0-2.987.012-4.043.06-1.064.049-1.791.219-2.427.465a4.902 4.902 0 01-1.772 1.153 4.902 4.902 0 01-1.153 1.772c-.247.636-.416 1.363-.465 2.427-.047 1.024-.06 1.379-.06 3.808v.027c0 2.43.013 2.784.06 3.808.049 1.064.218 1.791.465 2.427a4.902 4.902 0 011.153 1.772 4.902 4.902 0 011.772 1.153c.636.247 1.363.416 2.427.465 1.067.048 1.407.06 4.123.06h.08c2.643 0 2.987-.012 4.043-.06 1.064-.049 1.791-.218 2.427-.465a4.902 4.902 0 011.772-1.153 4.902 4.902 0 011.153-1.772c.247-.636.416-1.363.465-2.427.048-1.067.06-1.407.06-4.123v-.08c0-2.643-.012-2.987-.06-4.043-.049-1.064-.218-1.791-.465-2.427a4.902 4.902 0 01-1.153-1.772 4.902 4.902 0 01-1.772-1.153c-.636-.247-1.363-.416-2.427-.465-1.024-.047-1.379-.06-3.808-.06h-.027zm0-2c-2.572 0-2.96.01-4.015.059-.975.045-1.504.207-2.038.404-.55.207-1.02.477-1.45.907-.43.43-.7.9-.907 1.45-.197.534-.359 1.063-.404 2.038-.05 1.055-.06 1.443-.06 4.015s.01 2.96.059 4.015c.045.975.207 1.504.404 2.038.207.55.477 1.02.907 1.45.43.43.9.7 1.45.907.534.197 1.063.359 2.038.404 1.055.05 1.443.06 4.015.06s2.96-.01 4.015-.059c.975-.045 1.504-.207 2.038-.404.55-.207 1.02-.477 1.45-.907.43-.43.7-.9.907-1.45.197-.534.359-1.063.404-2.038.05-1.055.06-1.443.06-4.015s-.01-2.96-.059-4.015c-.045-.975-.207-1.504-.404-2.038-.207-.55-.477-1.02-.907-1.45-.43-.43-.9-.7-1.45-.907-.534-.197-1.063-.359-2.038-.404-1.055-.05-1.443-.06-4.015-.06zm-3.27 8.01c.711 0 1.29.579 1.29 1.29s-.579 1.29-1.29 1.29-1.29-.579-1.29-1.29.579-1.29 1.29-1.29zm6.58 0c.711 0 1.29.579 1.29 1.29s-.579 1.29-1.29 1.29-1.29-.579-1.29-1.29.579-1.29 1.29-1.29zm-3.29 3.29c0 .711.579 1.29 1.29 1.29s1.29-.579 1.29-1.29-.579-1.29-1.29-1.29-1.29.579-1.29 1.29z"/>
            </svg>
          </a>
        </div>
        <div class="text-sm">
          &copy; 2025 Eventify. All rights reserved.
        </div>
      </div>
    </div>
  </footer>


  <style>
    .glass-effect {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
  </style>

  <script type="module">
    import { auth, db } from './scripts/firebase.js';
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
    import { doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const userDisplay = document.getElementById('userDisplay');
    const loginLink = document.getElementById('loginLink');
    const registerLink = document.getElementById('registerLink');
    const logoutBtn = document.getElementById('logoutBtn');
    const eventDetails = document.getElementById('eventDetails');

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        loginLink.style.display = 'none';
        registerLink.style.display = 'none';
        logoutBtn.classList.remove('hidden');
        try {
          const docRef = doc(db, 'users', user.uid);
          const docSnap = await getDoc(docRef);
          const name = docSnap.exists() ? docSnap.data().firstName || user.email : user.email;
          userDisplay.textContent = `Hello, ${name}`;
        } catch {
          userDisplay.textContent = `Hello, ${user.email}`;
        }
      } else {
        userDisplay.textContent = '';
        loginLink.style.display = 'inline';
        registerLink.style.display = 'inline';
        logoutBtn.classList.add('hidden');
      }
    });

    logoutBtn.addEventListener('click', async () => {
      await signOut(auth);
      window.location.href = 'index.html';
    });

    const urlParams = new URLSearchParams(window.location.search);
    const eventId = urlParams.get('id');

    if (!eventId) {
      eventDetails.innerHTML = '<p class="text-red-500 text-center">No event ID provided.</p>';
    } else {
      async function fetchEventDetails() {
        try {
          const docRef = doc(db, 'events', eventId);
          const docSnap = await getDoc(docRef);

          if (docSnap.exists()) {
            const event = docSnap.data();
            const eventDate = event.date ? new Date(event.date.seconds * 1000) : null;
            const formattedDate = eventDate ? eventDate.toLocaleDateString() : 'No date';

            eventDetails.innerHTML = `
              <img src="${event.imageUrl || 'https://via.placeholder.com/800x400?text=No+Image'}" alt="${event.title}" class="rounded-lg mb-6 object-cover w-full max-h-96 mx-auto" />
              <h1 class="text-4xl font-bold mb-4">${event.title || 'No Title'}</h1>
              <p class="mb-2 text-gray-700"><strong>Date:</strong> ${formattedDate}</p>
              <p class="mb-2 text-gray-700"><strong>Location:</strong> ${event.location || 'Unknown'}</p>
              <p class="mb-6 text-gray-800 whitespace-pre-line">${event.description || 'No description available.'}</p>
              <a href="events.html" class="inline-block text-sky-600 hover:underline">‚Üê Back to Events</a>
            `;
          } else {
            eventDetails.innerHTML = '<p class="text-red-500 text-center">Event not found.</p>';
          }
        } catch (error) {
          eventDetails.innerHTML = `<p class="text-red-500 text-center">Error loading event: ${error.message}</p>`;
        }
      }

      fetchEventDetails();
    }
  </script>

</body>
</html>